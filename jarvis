
    
    print(f"ğŸ’¬ ì¸ì‹ëœ ëª…ë ¹: {command_raw}")

    # --- ëª¨ë“  íŒë‹¨ì„ Geminiì—ê²Œ ë§¡ê¹ë‹ˆë‹¤. ---
    final_command_key = None
    available_functions = list(COMMANDS.keys())
    
    function_descriptions = []
    for key, info in COMMANDS.items():
        description = f"- '{key}' (ê´€ë ¨ í‘œí˜„: {', '.join(info.get('aliases', []))})"
        function_descriptions.append(description)
    
    intent_prompt = (f"ë‹¹ì‹ ì€ ì‚¬ìš©ìì˜ ìì—°ì–´ ëª…ë ¹ì—ì„œ í•µì‹¬ ì˜ë„ë¥¼ íŒŒì•…í•˜ëŠ” AI ë‘ë‡Œì…ë‹ˆë‹¤. ì•„ë˜ 'ê¸°ëŠ¥ ì„¤ëª…'ì„ ì°¸ê³ í•˜ì—¬, ì£¼ì–´ì§„ 'ì‚¬ìš©ì ëª…ë ¹'ê³¼ ê°€ì¥ ì¼ì¹˜í•˜ëŠ” ê¸°ëŠ¥ì˜ ì´ë¦„(key) 'í•˜ë‚˜'ë§Œ ì •í™•íˆ ì¶œë ¥í•´ì£¼ì„¸ìš”.\n\n## ê¸°ëŠ¥ ì„¤ëª…:\n" + "\n".join(function_descriptions) + f"\n\n## ì§€ì‹œ:\nì í•©í•œ ê¸°ëŠ¥ì´ ìˆë‹¤ë©´ ê·¸ ê¸°ëŠ¥ì˜ ì´ë¦„ë§Œ, ì—†ë‹¤ë©´ 'NULL'ë§Œ ì¶œë ¥í•˜ì„¸ìš”.\n\n## ì‚¬ìš©ì ëª…ë ¹:\n\"{command_raw}\"")
    
    gemini_suggestion = ask_gemini(intent_prompt)
    
    if gemini_suggestion != "NULL" and gemini_suggestion in available_functions:
        final_command_key = gemini_suggestion
    
    result = ""
    if final_command_key:
        command_info = COMMANDS.get(final_command_key, {})
        action_type = command_info.get('action_type')
        if action_type == 'fetch_and_report':
            target_name = command_info.get('target_name')
            if target_name == 'í˜„ì¬ ë‚ ì”¨': result = get_weather_forecast()
            elif target_name == 'í˜„ì¬ ì‹œê°„': result = get_current_time()
        elif action_type == 'special':
            result = get_response_text(command_info)
            pyautogui.hotkey('win', 'shift', 's')
        elif action_type == 'empty':
            speak(f"ê²½ê³ , {command_info.get('target_name')}ì„(ë¥¼) ë¹„ìš°ë©´ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì •ë§ ì‹¤í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")
            confirm = input("ì •ë§ ì‹¤í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (y/n): ")
            result = execute(final_command_key) if confirm.lower() == 'y' else "ì‹¤í–‰ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤."
        else:
            result = execute(final_command_key)


    if result:
        speak(result)
